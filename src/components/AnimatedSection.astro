---
interface Props {
  delay?: number;
  className?: string;
}

const { delay = 0, className = "" } = Astro.props;
---

<div class={`animate-on-scroll ${className}`} data-delay={delay}>
  <slot />
</div>

<script>
  // Intersection Observer for scroll animations
  const observerOptions = {
    threshold: 0.1,
    rootMargin: "0px 0px -50px 0px",
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        const delay = entry.target.getAttribute("data-delay") || 0;
        setTimeout(() => {
          entry.target.classList.add("in-view");
        }, Number(delay));
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  document.addEventListener("DOMContentLoaded", () => {
    const elements = document.querySelectorAll(".animate-on-scroll");
    elements.forEach((el) => observer.observe(el));
  });
</script>

<style>
  .animate-on-scroll {
    opacity: 0;
    transform: translateY(30px);
    transition:
      opacity 0.6s cubic-bezier(0.25, 0.1, 0.25, 1),
      transform 0.6s cubic-bezier(0.25, 0.1, 0.25, 1);
  }

  .animate-on-scroll.in-view {
    opacity: 1;
    transform: translateY(0);
  }
</style>
